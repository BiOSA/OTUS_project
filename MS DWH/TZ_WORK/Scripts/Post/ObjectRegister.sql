MERGE dbo.ObjectRegister AS trg
USING
(
          SELECT 1 AS ObjectRegisterId, 'tz.Application' AS [Name],                   NULL AS StageTableName, NULL AS DDSTableName, 'src' AS TableNamePrefix,  1 AS DataSourceId, 'Заявки\займы'  AS [Description],                       '$(TZ_BPMONLINETZ_DB).dbo.[Application]' AS SourceTableName,     NULL AS DataPrepareProcedure, 'src.CreatedOn|src.ModifiedOn'                                                                       AS DataChangeField,    N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);' AS ExtendedQueryPre, NULL AS STGAdditionalPredicate,                                                       NULL AS DDSMainProcedure,                      'tz.ApplicationDDSPostProcess' AS DDSPostProcedure, 10 AS SaveDepth, 0 AS HasDDSCodeTranslate, 1 AS IsEnabled, 1 AS CheckInBatch, 1 AS HasSTGCodeTranslate, NULL AS STGPostProcedure
    UNION SELECT 2,                     'tz.MaritalStatus',                           NULL,                   NULL,                 'src',                     1,                 'Справочник семейного положения',                       '$(TZ_BPMONLINETZ_DB).dbo.MaritalStatus',                        NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 3,                     'tz.Education',                               NULL,                   NULL,                 'src',                     1,                 'Справочник образования',                               '$(TZ_BPMONLINETZ_DB).dbo.Education',                            NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 4,                     'tz.Gender',                                  NULL,                   NULL,                 'src',                     1,                 'Справочник полов',                                     '$(TZ_BPMONLINETZ_DB).dbo.Gender',                               NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 5,                     'tz.Busyness',                                NULL,                   NULL,                 'src',                     1,                 'Справочник занятости',                                 '$(TZ_BPMONLINETZ_DB).dbo.Busyness',                             NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 6,                     'tz.Contact',                                 NULL,                   NULL,                 'src',                     1,                 'Клиенты',                                              '$(TZ_BPMONLINETZ_DB).dbo.Contact',                              NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              0                       , 1             , 1                , 1                       , NULL
    UNION SELECT 7,                     'tz.ProductType',                             NULL,                   NULL,                 'src',                     1,                 'Типы продуктов',                                       '$(TZ_BPMONLINETZ_DB).dbo.ProductType',                          NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 8,                     'tz.Product',                                 NULL,                   NULL,                 'src',                     1,                 'Продукты',                                             '$(TZ_BPMONLINETZ_DB).dbo.Product',                              NULL,                         'ISNULL(src.ModifiedOn, src.CreatedOn)',                                                                                    N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 9,                     'tz.ApplicationStatus',                       NULL,                   NULL,                 'src',                     1,                 'Справочник статусов заявки',                           '$(TZ_BPMONLINETZ_DB).dbo.ApplicationStatus',                    NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 10,                    'tz.ApplicationAudit',                        NULL,                   NULL,                 'src',                     1,                 'История изменения статусов заявки',                    '$(TZ_BPMONLINETZ_DB).dbo.Application_Audit',                    NULL,                         'ChangeDate',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 'tz.ApplicationAuditDDSMainProcedure',         NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 11,                    'tz.FinancingInstrument',                     NULL,                   NULL,                 'src',                     1,                 'Финансовый инструмент',                                '$(TZ_BPMONLINETZ_DB).dbo.FinancingInstrument',                  NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 12,                    'tz.FinancingInstrumentType',                 NULL,                   NULL,                 'src',                     1,                 'Типы финансовых инструментов',                         '$(TZ_BPMONLINETZ_DB).dbo.FinancingInstrumentType',              NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 13,                    'tz.FinancingInstrumentStatus',               NULL,                   NULL,                 'src',                     1,                 'Статусы финансовых инструментов',                      '$(TZ_BPMONLINETZ_DB).dbo.FinancingInstrumentStatus',            NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 14,                    'tz.VwCheckBankScoringValue',                 NULL,                   NULL,                 'src',                     1,                 'Идентификация банковская',                             '$(TZ_BPMONLINETZ_DB).dbo.VwCheckBankScoringValue',              NULL,                         'CreatedOn',                                                                                                                N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 15,                    'tz.Verification',                            NULL,                   NULL,                 'src',                     1,                 'Верификация',                                          '$(TZ_BPMONLINETZ_DB).dbo.Verification',                         NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              0                       , 1             , 1                , 1                       , NULL
    UNION SELECT 16,                    'tz.VerificationListResult',                  NULL,                   NULL,                 'src',                     1,                 'Результат действий верификации',                       '$(TZ_BPMONLINETZ_DB).dbo.VerificationListResult',               NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 17,                    'tz.VerificationListItem',                    NULL,                   NULL,                 'src',                     1,                 'Действие верификации',                                 '$(TZ_BPMONLINETZ_DB).dbo.VerificationListItem',                 NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 18,                    'tz.Cashflow',                                NULL,                   NULL,                 'src',                     1,                 'Операция',                                             '$(TZ_BPMONLINETZ_DB).dbo.Cashflow',                             NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 19,                    'tz.CashflowCategory',                        NULL,                   NULL,                 'src',                     1,                 'Категория операции',                                   '$(TZ_BPMONLINETZ_DB).dbo.CashflowCategory',                     NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 20,                    'tz.CashflowSource',                          NULL,                   NULL,                 'src',                     1,                 'Источники операций',                                   '$(TZ_BPMONLINETZ_DB).dbo.CashflowSource',                       NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 21,                    'tz.CashflowStatus',                          NULL,                   NULL,                 'src',                     1,                 'Состояния операций',                                   '$(TZ_BPMONLINETZ_DB).dbo.CashflowStatus',                       NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 22,                    'tz.CashflowTypes',                           NULL,                   NULL,                 'src',                     1,                 'Типы операций',                                        '$(TZ_BPMONLINETZ_DB).dbo.CashflowTypes',                        NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 23,                    'tz.Calculator_MMK_customer',                 NULL,                   NULL,                 'src',                     5,                 'Клиенты Быстроденег',                                  'risk_storage.dbo.tz_data',                                      NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;',                                                                                                                              '(Name NOT LIKE ''%DЕLЕТЕRЕQUЕSТ%'')',                                                NULL,                                          NULL                                              , 3,               0                       , 1             , 0                , 0                       , NULL
    UNION SELECT 24,                    'risk_spr.Application_final',                 NULL,                   NULL,                 'src',                     CASE (SELECT Name FROM tz_dwh.Business)
                                                                                                                                                                   WHEN 'Eqvazaim'  THEN 2  --risk_spr находится на линке
                                                                                                                                                                   WHEN 'Turbozaim' THEN 4  --risk_spr находится на той же ноге, что хранилище
                                                                                                                                                               END,               'Факт обработки на новой системе принятия решений',     
                                                                                                                                                                                                                                           CASE (SELECT Name FROM tz_dwh.Business)
                                                                                                                                                                                                                                               WHEN 'Eqvazaim'  THEN '$(RISK_SPR_DB).ez_app.Application_final'
                                                                                                                                                                                                                                               WHEN 'Turbozaim' THEN '$(RISK_SPR_DB).tz_app.Application_final'
                                                                                                                                                                                                                                           END,                                                            NULL,                         NULL,                                                                                                                       N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;',                                                                                                                              '(TRY_CAST(application_number AS UNIQUEIDENTIFIER) IS NOT NULL OR application_number IS NULL)', NULL,                                NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 25,                    'bd_marts.BD_MaxContactDeals',                NULL,                   NULL,                 'src',                     3,                 'Клиенты Быстроденег из витрин хранилища БД',           '$(DWH_MARTS_DB).pbi.v_BD_MaxContactDeals',                      NULL,                         'LAST_DEAL_OPEN_DT',                                                                                                        N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;',                                                                                                                              '(FIO NOT LIKE ''%DELETE%'')',                                                        NULL,                                          NULL                                              , 10,              0                       , 1             , 1                , 0                       , NULL
    UNION SELECT 26,                    'tz.Balance',                                 NULL,                   NULL,                 'src',                     1,                 'Баланс',                                               '$(TZ_BPMONLINETZ_DB).dbo.Balance',                              NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 27,                    'tz.PaymentSchedule',                         NULL,                   NULL,                 'src',                     1,                 'График платежей',                                      '$(TZ_BPMONLINETZ_DB).dbo.PaymentSchedule',                      NULL,                         'ISNULL(src.ModifiedOn, src.CreatedOn)',                                                                                    N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 28,                    'tz.ApplicationFile',                         NULL,                   NULL,                 'src',                     1,                 'Файл и ссылка займа',                                  '$(TZ_BPMONLINETZ_DB).dbo.ApplicationFile',                      NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 29,                    'tz.ContactIntegration',                      NULL,                   NULL,                 'src',                     1,                 'Интеграция с контактом',                               '$(TZ_BPMONLINETZ_DB).dbo.ContactIntegration',                   NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 30,                    'tz.AgredatorServiceLog',                     NULL,                   NULL,                 'src',                     1,                 'Интеграция с ПФР, ФНС. Ответы',                        '$(TZ_BPMONLINETZ_DB).dbo.AgredatorServiceLog',                  NULL,                         'CreatedOn',                                                                                                                N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 31,                    'tz.AgredatorRequestLog',                     NULL,                   NULL,                 'src',                     1,                 'Интеграция с ПФР, ФНС. Запросы',                       '$(TZ_BPMONLINETZ_DB).dbo.AgredatorRequestLog',                  NULL,                         'ResponseDate',                                                                                                             N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 32,                    'tz.ApplicationApproval',                     NULL,                   NULL,                 'src',                     1,                 'Виза в заявке',                                        '$(TZ_BPMONLINETZ_DB).dbo.ApplicationApproval',                  NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 33,                    'tz.ApprovalStatus',                          NULL,                   NULL,                 'src',                     1,                 'Состояние визы',                                       '$(TZ_BPMONLINETZ_DB).dbo.ApprovalStatus',                       NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 34,                    'tz.ContactAddress',                          NULL,                   NULL,                 'src',                     1,                 'Адрес контакта',                                       '$(TZ_BPMONLINETZ_DB).dbo.ContactAddress',                       NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     '(ContactId IS NOT NULL)',                                                            NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 35,                    'tz.AddressType',                             NULL,                   NULL,                 'src',                     1,                 'Тип адреса',                                           '$(TZ_BPMONLINETZ_DB).dbo.AddressType',                          NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 36,                    'tz.Region',                                  NULL,                   NULL,                 'src',                     1,                 'Регионы РФ',                                           '$(TZ_BPMONLINETZ_DB).dbo.Region',                               NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 37,                    'tz.ApplicationIntegration',                  NULL,                   NULL,                 'src',                     1,                 'Данные об интеграциях для займа',                      '$(TZ_BPMONLINETZ_DB).dbo.ApplicationIntegration',               NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 38,                    'tz.ApplicationDecision',                     NULL,                   NULL,                 'src',                     1,                 'Решение по заявке',                                    '$(TZ_BPMONLINETZ_DB).dbo.ApplicationDecision',                  NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 39,                    'tz.DecisionReasons',                         NULL,                   NULL,                 'src',                     1,                 'Причины решений',                                      '$(TZ_BPMONLINETZ_DB).dbo.DecisionReasons',                      NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 40,                    'tz.CalculatorSetup',                         NULL,                   NULL,                 'src',                     1,                 'Настройки подбора продукта клииенту',                  '$(TZ_BPMONLINETZ_DB).dbo.CalculatorSetup',                      NULL,                         NULL/*Поле ModifiedOn есть, но оно не обновляется*/,                                                                        N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;',                                                                                                                              NULL,                                                                                 NULL,                                          NULL                                              , 10,              0                       , 1             , 0                , 0                       , NULL
    UNION SELECT 41,                    'tz.SandboxInputLog',                         NULL,                   NULL,                 'src',                     1,                 'SandboxInputLog',                                      '$(TZ_BPMONLINETZ_DB).dbo.SandboxInputLog',                      NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          'tz.SandboxInputLogDDSPostProcess'                , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 42,                    'tz.PersCabFile',                             NULL,                   NULL,                 'src',                     1,                 'Документ в Личном кабинете',                           '$(TZ_BPMONLINETZ_DB).dbo.PersCabFile',                          NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 43,                    'tz.TinkoffIDResponseTrace',                  NULL,                   NULL,                 'src',                     1,                 'Лог ответов Тинькова',                                 '$(TZ_BPMONLINETZ_DB).dbo.TinkoffIDResponseTrace',               NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     '(src.ContactId IS NOT NULL)',                                                        NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 44,                    'tz.AdditionalProduct',                       NULL,                   NULL,                 'src',                     1,                 'Дополнительные продукты',                              '$(TZ_BPMONLINETZ_DB).dbo.AdditionalProduct',                    NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 45,                    'tz.AdditionalProductStatus',                 NULL,                   NULL,                 'src',                     1,                 'Статусы по доп.продуктам',                             '$(TZ_BPMONLINETZ_DB).dbo.AdditionalProductStatus',              NULL,                         'ISNULL(src.ModifiedOn, src.CreatedOn)',                                                                                    N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 46,                    'tz.ApplicationAdditionalProduct',            NULL,                   NULL,                 'src',                     1,                 'Связь доп.продуктов и займов',                         '$(TZ_BPMONLINETZ_DB).dbo.ApplicationAdditionalProduct',         NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 47,                    'tz.AdditionalAgreement',                     NULL,                   NULL,                 'src',                     1,                 'Пролонгации',                                          '$(TZ_BPMONLINETZ_DB).dbo.AdditionalAgreement',                  NULL,                         'ISNULL(src.ModifiedOn, src.CreatedOn)',                                                                                    N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 48,                    'tz.AdditionalAgreementStatus',               NULL,                   NULL,                 'src',                     1,                 'Статусы пролонгаций',                                  '$(TZ_BPMONLINETZ_DB).dbo.AdditionalAgreementStatus',            NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 49,                    'tz.AdditionalAgreementType',                 NULL,                   NULL,                 'src',                     1,                 'Типы пролонгаций',                                     '$(TZ_BPMONLINETZ_DB).dbo.AdditionalAgreementType',              NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 50,                    'tz.AdditionalProductType',                   NULL,                   NULL,                 'src',                     1,                 'Типы доп.продуктов',                                   '$(TZ_BPMONLINETZ_DB).dbo.AdditionalProductType',                NULL,                         'ISNULL(src.ModifiedOn, src.CreatedOn)',                                                                                    N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 51,                    'tz.PaySystemOrder',                          NULL,                   NULL,                 'src',                     1,                 'PaySystemOrder',                                       '$(TZ_BPMONLINETZ_DB).dbo.PaySystemOrder',                       NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 1                , 0                       , NULL
    UNION SELECT 52,                    'tz.Accrual',                                 NULL,                   NULL,                 'src',                     1,                 'Начисления',                                           '$(TZ_BPMONLINETZ_DB).dbo.Accrual',                              NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              0                       , 1             , 1                , 1                       , NULL
    UNION SELECT 53,                    'tz.AccrualStatus',                           NULL,                   NULL,                 'src',                     1,                 'Статусы начислений',                                   '$(TZ_BPMONLINETZ_DB).dbo.AccrualStatus',                        NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 54,                    'sandbox.TestClient',                         NULL,                   NULL,                 'src',                     4,                 'Тестовые клиенты Sandbox',                             '$(TZ_DWH_DB).sandbox.TestClient',                               NULL,                         NULL,                                                                                                                       N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;',                                                                                                                              NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 55,                    'tz.ApplicationTestParameters',               NULL,                   NULL,                 'src',                     1,                 'Тестовые клиенты TZ',                                  '$(TZ_BPMONLINETZ_DB).dbo.ApplicationTestParameters',            NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 56,                    'tz.LegalCollectionContractStatus',           NULL,                   NULL,                 'src',                     1,                 'Статусы просуживания',                                 '$(TZ_BPMONLINETZ_DB).dbo.LegalCollectionContractStatus',        NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 57,                    'tz.LegalCollectionContract',                 NULL,                   NULL,                 'src',                     1,                 'Просуживания',                                         '$(TZ_BPMONLINETZ_DB).dbo.LegalCollectionContract',              NULL,                         'ModifiedOn',                                                                                                               N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 58,                    'tz.LegalCollectionContractStatusHistory',    NULL,                   NULL,                 'src',                     1,                 'История смены статусов просуживания',                  '$(TZ_BPMONLINETZ_DB).dbo.LegalCollectionContractStatusHistory', NULL,                         'src.CreatedOn',                                                                                                            N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              1                       , 1             , 0                , 0                       , NULL
    UNION SELECT 59,                    'tz.ApplicationAddress',                      NULL,                   NULL,                 'src',                     1,                 'Адреса, указанные при заполнении заявки',              '$(TZ_BPMONLINETZ_DB).dbo.ApplicationAddress',                   NULL,                         'ISNULL(src.ModifiedOn, src.CreatedOn)',                                                                                    N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              0                       , 1             , 1                , 1                       , 'tz.ApplicationAddressSTGPostProcess'
    UNION SELECT 60,                    'tz.CreditLimitContractStatus',               NULL,                   NULL,                 'src',                     1,                 'Статусы займов по кредитным линиям',                   '$(TZ_BPMONLINETZ_DB).dbo.CreditLimitContractStatus',            NULL,                         'ISNULL(src.ModifiedOn, src.CreatedOn)',                                                                                    N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              0                       , 1             , 0                , 1                       , NULL
    UNION SELECT 61,                    'tz.CreditLimitContract',                     NULL,                   NULL,                 'src',                     1,                 'Контракты кредитных линий',                            '$(TZ_BPMONLINETZ_DB).dbo.CreditLimitContract',                  NULL,                         'src.ModifiedOn',                                                                                                           N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              0                       , 1             , 0                , 1                       , NULL
    UNION SELECT 62,                    'tz.CreditLimitTransh',                       NULL,                   NULL,                 'src',                     1,                 'Транши по кредитным линиям',                           '$(TZ_BPMONLINETZ_DB).dbo.CreditLimitTransh',                    NULL,                         'src.ModifiedOn',                                                                                                           N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              0                       , 1             , 0                , 1                       , NULL
    UNION SELECT 63,                    'tz.CreditLimit',                             NULL,                   NULL,                 'src',                     1,                 'Проекты кредитных линий',                              '$(TZ_BPMONLINETZ_DB).dbo.CreditLimit',                          NULL,                         'ISNULL(src.ModifiedOn, src.CreatedOn)',                                                                                    N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              0                       , 1             , 0                , 1                       , NULL
    UNION SELECT 64,                    'tz.APSKHistory',                             NULL,                   NULL,                 'src',                     1,                 'АПСК',                                                 '$(TZ_BPMONLINETZ_DB).dbo.APSKHistory',                          NULL,                         'src.CreatedOn',                                                                                                            N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              0                       , 1             , 1                , 1                       , NULL
    UNION SELECT 65,                    'tz.APSKCalculationEvent',                    NULL,                   NULL,                 'src',                     1,                 'АПСК События расчета',                                 '$(TZ_BPMONLINETZ_DB).dbo.APSKCalculationEvent',                 NULL,                         'ISNULL(src.ModifiedOn, src.CreatedOn)',                                                                                    N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          NULL                                              , 10,              0                       , 1             , 0                , 1                       , NULL
    UNION SELECT 66,                    'tz.AccrualCancel',                           NULL,                   NULL,                 'src',                     1,                 'Отмененные начисления',                                '$(TZ_BPMONLINETZ_DB).dbo.AccrualCancel',                        NULL,                         'src.CancelDate',                                                                                                           N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          'tz.AccrualCancelDDSPostProcess'                  , 10,              0                       , 1             , 1                , 1                       , NULL
    UNION SELECT 67,                    'tz.CashflowCancel',                          NULL,                   NULL,                 'src',                     1,                 'Отмененные операции',                                  '$(TZ_BPMONLINETZ_DB).dbo.CashflowCancel',                       NULL,                         'src.CancelDate',                                                                                                           N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          'tz.CashflowCancelDDSPostProcess'                 , 10,              0                       , 1             , 1                , 1                       , NULL
    UNION SELECT 68,                    'tz.BalanceCancel',                           NULL,                   NULL,                 'src',                     1,                 'Отмененные балансовые операции',                       '$(TZ_BPMONLINETZ_DB).dbo.BalanceCancel',                        NULL,                         'src.CancelDate',                                                                                                           N'SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;SET NOCOUNT ON;SELECT @DateTill = DATEADD(HOUR, -3, @DateTill), @DateFrom = DATEADD(HOUR, -3, @DateFrom);',                     NULL,                                                                                 NULL,                                          'tz.BalanceCancelDDSPostProcess'                  , 10,              0                       , 1             , 1                , 1                       , NULL
) AS src (ObjectRegisterId, [Name], StageTableName, DDSTableName, TableNamePrefix, DataSourceId, [Description], SourceTableName, DataPrepareProcedure, DataChangeField, ExtendedQueryPre, STGAdditionalPredicate, DDSMainProcedure, DDSPostProcedure, SaveDepth, HasDDSCodeTranslate, IsEnabled, CheckInBatch, HasSTGCodeTranslate, STGPostProcedure)
ON src.ObjectRegisterId = trg.ObjectRegisterId
WHEN NOT MATCHED BY TARGET THEN
    INSERT (ObjectRegisterId, [Name], StageTableName, DDSTableName, TableNamePrefix, DataSourceId, [Description], SourceTableName, DataPrepareProcedure, DataChangeField, ExtendedQueryPre, STGAdditionalPredicate, DDSMainProcedure, DDSPostProcedure, SaveDepth, HasDDSCodeTranslate, IsEnabled, CheckInBatch, HasSTGCodeTranslate, STGPostProcedure)
    VALUES (src.ObjectRegisterId, src.[Name], src.StageTableName, src.DDSTableName, src.TableNamePrefix, src.DataSourceId, src.[Description], src.SourceTableName, src.DataPrepareProcedure, src.DataChangeField, src.ExtendedQueryPre, src.STGAdditionalPredicate, src.DDSMainProcedure, src.DDSPostProcedure, src.SaveDepth, src.HasDDSCodeTranslate, src.IsEnabled, src.CheckInBatch, src.HasSTGCodeTranslate, src.STGPostProcedure)
WHEN NOT MATCHED BY SOURCE THEN
    DELETE
WHEN MATCHED THEN
    UPDATE SET
          trg.[Name]                  = src.[Name]
        , trg.StageTableName          = src.StageTableName
        , trg.DDSTableName            = src.DDSTableName
        , trg.TableNamePrefix         = src.TableNamePrefix
        , trg.DataSourceId            = src.DataSourceId
        , trg.[Description]           = src.[Description]
        , trg.SourceTableName         = src.SourceTableName
        , trg.DataPrepareProcedure    = src.DataPrepareProcedure
        , trg.DataChangeField         = src.DataChangeField
        , trg.ExtendedQueryPre        = src.ExtendedQueryPre
        , trg.STGAdditionalPredicate  = src.STGAdditionalPredicate
        , trg.DDSMainProcedure        = src.DDSMainProcedure
        , trg.DDSPostProcedure        = src.DDSPostProcedure
        , trg.SaveDepth               = src.SaveDepth
        , trg.HasDDSCodeTranslate     = src.HasDDSCodeTranslate
        , trg.IsEnabled               = src.IsEnabled
        , trg.CheckInBatch            = src.CheckInBatch
        , trg.HasSTGCodeTranslate     = src.HasSTGCodeTranslate
        , trg.STGPostProcedure        = src.STGPostProcedure;